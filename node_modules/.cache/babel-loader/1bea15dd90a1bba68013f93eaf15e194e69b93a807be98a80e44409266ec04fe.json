{"ast":null,"code":"import React,{useState,useEffect}from'react';import MapComponent from'./components/MapComponent';import IncidentForm from'./components/IncidentForm';import GoogleAuth from'./components/GoogleAuth';import GuardsManager from'./components/GuardsManager';import ZoneCreator from'./components/ZoneCreator';import IncidentList from'./components/IncidentList';// Agregar esta línea\nimport{sheetsService}from'./services/sheetsService';// Remove the './App.css' import since we're using Tailwind CSS\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function App(){// Temporalmente establecemos isAuthenticated como true para desarrollo\nconst[isAuthenticated,setIsAuthenticated]=useState(true);const[incidents,setIncidents]=useState([]);const[currentModule,setCurrentModule]=useState('incidents');// Inicialización temporal del sheetsService\nuseEffect(()=>{sheetsService.init('AIzaSyAgLNdE8AzuxsQL4hzKg94Z65cFuNWTQfoI');// Reemplazar con token real\n},[]);// Comentamos temporalmente las funciones de autenticación\n/*\n  const handleAuthSuccess = (accessToken) => {\n    console.log('App: Autenticación exitosa.');\n    // Inicializar el servicio de Sheets con el token\n    const initialized = sheetsService.init(accessToken);\n    if (initialized) {\n      setIsAuthenticated(true);\n      // Opcional: Cargar datos iniciales si es necesario\n      // loadInitialData();\n    } else {\n      console.error(\"App: No se pudo inicializar SheetsService.\");\n      // Manejar el error, quizás mostrar un mensaje al usuario\n    }\n  };\n\n  // Callback para cuando la autenticación falla\n  const handleAuthFailure = (error) => {\n    console.error('App: Falló la autenticación.', error);\n    setIsAuthenticated(false);\n    // Limpiar cualquier estado relacionado con el usuario autenticado\n  };\n  */// Función para guardar datos (ahora usa sheetsService)\nconst handleSaveIncident=async incidentData=>{var _incidentData$locatio,_incidentData$locatio2;// Comentamos temporalmente la verificación de autenticación\n/*\n    if (!isAuthenticated || !sheetsService.isInitialized()) {\n      alert('Por favor, inicia sesión con Google primero.');\n      return;\n    }\n    */const values=[new Date().toLocaleString(),// Fecha y hora\nincidentData.type||'',// Tipo de incidente\nincidentData.description||'',// Descripción\n((_incidentData$locatio=incidentData.location)===null||_incidentData$locatio===void 0?void 0:_incidentData$locatio.lat)||'',// Latitud\n((_incidentData$locatio2=incidentData.location)===null||_incidentData$locatio2===void 0?void 0:_incidentData$locatio2.lng)||'',// Longitud\nincidentData.status||'Pendiente',// Estado del incidente\nincidentData.assignedTo||''// Asignado a\n];try{const result=await sheetsService.addRecord('Incidentes',values);console.log('Incidente guardado:',result);alert('Incidente registrado con éxito');// Actualizar la lista de incidentes\nconst updatedIncidents=await sheetsService.getRecords('Incidentes');setIncidents(updatedIncidents);}catch(error){console.error('Error al guardar:',error);alert(`Error al guardar el incidente: ${error.message}`);}};// Opcional: Función para cargar datos iniciales\n// async function loadInitialData() {\n//   if (sheetsService.isInitialized()) {\n//     const data = await sheetsService.getRecords('Incidentes'); // Asume hoja 'Incidentes'\n//     if (data) {\n//       // Procesa los datos y actualiza el estado 'incidents'\n//       console.log(\"Datos cargados:\", data);\n//       // setIncidents(processedData);\n//     }\n//   }\n// }\n// Función para renderizar el módulo actual\nconst renderCurrentModule=()=>{switch(currentModule){case'incidents':return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-1 h-full\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-1/2 overflow-y-auto\",style:{height:'calc(100vh - 120px)'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(IncidentForm,{onSave:handleSaveIncident}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:/*#__PURE__*/_jsx(IncidentList,{incidents:incidents,onIncidentSelect:incident=>{// Manejar la selección de incidente\n}})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-1/2 relative\",children:/*#__PURE__*/_jsx(MapComponent,{incidents:incidents,onLocationSelect:location=>{// Manejar la selección de ubicación\n}})})]});case'guards':return/*#__PURE__*/_jsx(GuardsManager,{guards:[],setGuards:()=>{},saveData:()=>{}});case'zones':return/*#__PURE__*/_jsx(ZoneCreator,{zones:[],setZones:()=>{},saveData:()=>{}});default:return/*#__PURE__*/_jsx(\"div\",{children:\"Seleccione un m\\xF3dulo\"});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"App flex flex-col h-screen\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"bg-gray-800 text-white p-4 flex justify-between items-center\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold\",children:\"ZoneGuard Pro - Panel de Control\"})}),/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"nav\",{className:\"bg-gray-100 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentModule('incidents'),className:`px-4 py-2 rounded ${currentModule==='incidents'?'bg-blue-500 text-white':'bg-gray-200'}`,children:\"Incidentes\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentModule('guards'),className:`px-4 py-2 rounded ${currentModule==='guards'?'bg-blue-500 text-white':'bg-gray-200'}`,children:\"Guardias\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentModule('zones'),className:`px-4 py-2 rounded ${currentModule==='zones'?'bg-blue-500 text-white':'bg-gray-200'}`,children:\"Zonas\"})]})}),/*#__PURE__*/_jsx(\"main\",{className:\"flex-1 overflow-hidden\",children:renderCurrentModule()})]}),/*#__PURE__*/_jsx(\"footer\",{className:\"bg-gray-200 text-center p-2 text-sm\",children:\"\\xA9 2023 ZoneGuard Pro\"})]});}export default App;// DONE","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}